# ResNet50 Model Configuration

model:
  name: "resnet50"
  architecture: "ResNet50"

  # Backbone settings
  pretrained: true
  freeze_backbone: false
  freeze_bn: false

  # Output head
  num_classes: 7
  dropout: 0.5

  # Feature extraction
  feature_dim: 2048
  pool_type: "adaptive_avg"  # Options: adaptive_avg, adaptive_max, gem

  # Initialization
  init_method: "kaiming_normal"
  init_gain: 0.02

# Training configuration
training:
  # Optimizer
  optimizer:
    name: "adam"
    lr: 0.0001
    weight_decay: 0.0001
    betas: [0.9, 0.999]
    eps: 1e-8

  # Learning rate scheduler
  scheduler:
    name: "cosine_annealing"
    T_max: 100
    eta_min: 1e-6
    warmup_epochs: 5

  # Loss function
  loss:
    name: "cross_entropy"
    label_smoothing: 0.1
    class_weights: null  # Will be computed from data

  # Training hyperparameters
  max_epochs: 100
  gradient_clip_val: 1.0
  accumulate_grad_batches: 1

  # Early stopping
  early_stopping:
    patience: 20
    min_delta: 0.0001
    monitor: "val_loss"
    mode: "min"

  # Checkpointing
  checkpoint:
    monitor: "val_loss"
    mode: "min"
    save_top_k: 3
    save_last: true

  # Logging
  log_every_n_steps: 50
  eval_every_n_epochs: 1

# Evaluation configuration
evaluation:
  batch_size: 64
  num_workers: 4

  # Metrics to compute
  metrics:
    - "accuracy"
    - "balanced_accuracy"
    - "f1_macro"
    - "f1_weighted"
    - "precision_macro"
    - "recall_macro"
    - "auroc_macro"
    - "confusion_matrix"

  # Test-time augmentation
  tta:
    enabled: false
    num_augments: 5

# Hardware configuration
hardware:
  accelerator: "gpu"
  devices: 1
  precision: 16  # Mixed precision training

  # Memory optimization
  gradient_checkpointing: false
  channels_last: true
