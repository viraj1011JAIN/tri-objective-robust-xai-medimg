# ResNet-101 Model Configuration
# Larger variant with more depth

model:
  name: resnet101
  architecture: resnet101
  pretrained: true
  num_classes: 7
  
  in_channels: 3
  features_only: false
  out_indices: [4]
  norm_layer: batch_norm
  drop_rate: 0.0
  global_pool: avg

training:
  optimizer:
    type: adamw
    lr: 0.00005  # Lower LR for larger model
    weight_decay: 0.01
    betas: [0.9, 0.999]
    
  scheduler:
    type: cosine
    T_max: 100
    eta_min: 0.000001
    
  loss:
    type: cross_entropy
    label_smoothing: 0.1
    
  batch_size: 16  # Smaller batch for larger model
  num_epochs: 100
  gradient_clip: 1.0
  use_amp: true

augmentation:
  train:
    - RandomResizedCrop:
        size: 224
        scale: [0.8, 1.0]
    - RandomHorizontalFlip:
        p: 0.5
    - RandomVerticalFlip:
        p: 0.5
    - RandomRotation:
        degrees: 15
    - ColorJitter:
        brightness: 0.1
        contrast: 0.1
        saturation: 0.1
        hue: 0.05
    - Normalize:
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
        
  val:
    - Resize:
        size: 256
    - CenterCrop:
        size: 224
    - Normalize:
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]

capacity:
  parameters: 44549160  # ~44.5M parameters
  flops: 7801405440  # ~7.8 GFLOPs

tasks:
  dermoscopy:
    num_classes: 7
    batch_size: 16
    image_size: 224
    
  chest_xray:
    num_classes: 14
    batch_size: 8
    image_size: 224
    loss:
      type: bce_with_logits
      
  retinopathy:
    num_classes: 5
    batch_size: 16
    image_size: 224
